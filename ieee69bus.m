branches=[%From	To	R+jX(ohms)
	1	2	0.0005+1i*0.0012
    2	3	0.0005+1i*0.0012
    3	4	0.0015+1i*0.0036
    4	5	0.0251+1i*0.0294
    5	6	0.3660+1i*0.1864
    6	7	0.3811+1i*0.1941
    7	8	0.0922+1i*0.0470
    8	9	0.0493+1i*0.0251
    9	10	0.8190+1i*0.2707
    10	11	0.1872+1i*0.0619
    11	12	0.7114+1i*0.2351
    12	13	1.0300+1i*0.3400
    13	14	1.0440+1i*0.3450
    14	15	1.0580+1i*0.3496
    15	16	0.1966+1i*0.0650
    16	17	0.3744+1i*0.1238
    17	18	0.0047+1i*0.0016
    18	19	0.3276+1i*0.1083
    19	20	0.2106+1i*0.0690
    20	21	0.3416+1i*0.1129
    21	22	0.0140+1i*0.0046
    22	23	0.1591+1i*0.0526
    23	24	0.3463+1i*0.1145
    24	25	0.7488+1i*0.2475
    25	26	0.3089+1i*0.1021
    26	27	0.1732+1i*0.0572
    3	28	0.0044+1i*0.0108
    28	29	0.0640+1i*0.1565
    29	30	0.3978+1i*0.1315
    30	31	0.0702+1i*0.0232
    31	32	0.3510+1i*0.1160
    32	33	0.8390+1i*0.2816
    33	34	1.7080+1i*0.5646
    34	35	1.4740+1i*0.4873
    3	36	0.0044+1i*0.0108
    36	37	0.0640+1i*0.1565
    37	38	0.1053+1i*0.1230
    38	39	0.0304+1i*0.0355
    39	40	0.0018+1i*0.0021
    40	41	0.7283+1i*0.8509
    41	42	0.3100+1i*0.3623
    42	43	0.0410+1i*0.0478
    43	44	0.0092+1i*0.0116
    44	45	0.1089+1i*0.1373
    45	46	0.0009+1i*0.0012
    4	47	0.0034+1i*0.0084
    47	48	0.0851+1i*0.2083
    48	49	0.2898+1i*0.7091
    49	50	0.0822+1i*0.2011
    8	51	0.0928+1i*0.0473
    51	52	0.3319+1i*0.1114
    52	53	0.1740+1i*0.0886
    53	54	0.2030+1i*0.1034
    54	55	0.2842+1i*0.1447
    55	56	0.2813+1i*0.1433
    56	57	1.5900+1i*0.5337
    57	58	0.7837+1i*0.2630
    58	59	0.3042+1i*0.1006
    59	60	0.3861+1i*0.1172
    60	61	0.5075+1i*0.2585
    61	62	0.0974+1i*0.0496
    62	63	0.1450+1i*0.0738
    63	64	0.7105+1i*0.3619
    64	65	1.0410+1i*0.5302
    11	66	0.2012+1i*0.0611
    66	67	0.0047+1i*0.0014
    12	68	0.7394+1i*0.2444
    68	69	0.0047+1i*0.0016
    ];
spotloads = [%Bus Number	P+jQ(KVA)
    6	2.6+1i*2.2
    7	40.4+1i*30
    8	75+1i*54
    9	30+1i*22
    10	28+1i*19
    11	145+1i*104
    12	145+1i*104
    13	8+1i*5
    14	8+1i*5.5
    16	45.5+1i*30
    17	60+1i*35
    18	60+1i*35
    20	1+1i*0.6
    21	114+1i*81
    22	5+1i*3.5
    24	28+1i*20
    26	14+1i*10
    27	14+1i*10
    28	26+1i*18.6
    29	26+1i*18.6
    33	14+1i*10
    34	9.5+1i*14
    35	6+1i*4
    36	26+1i*18.55
    37	26+1i*18.55
    39	24+1i*17
    40	24+1i*17
    41	1.2+1i*1
    43	6+1i*4.3
    45	39.22+1i*26.3
    46	39.22+1i*26.3
    48	79+1i*56.4
    49	384.7+1i*274.5
    50	384.7+1i*274.5
    51	40.5+1i*28.3
    52	3.6+1i*2.7
    53	4.35+1i*3.5
    54	26.4+1i*19
    55	24+1i*17.2
    59	100+1i*72
    61	1244+1i*888
    62	32+1i*23
    64	227+1i*162
    65	59+1i*42
    66	18+1i*13
    67	18+1i*13
    68	28+1i*20
    69	28+1i*20
    ];
spotloads=[spotloads(:,1) spotloads(:,2)*1e3];%P+jQ(VA)
Vb = 12.66;%(kV)
Vb = Vb*1e3;%(V)
rn = 1;% root node
[V, I] = load_flow(branches ,rn ,Vb , spotloads);
plot(abs(V(:,1)),abs(V(:,2)))
set(get(gca,'YAxis'),'Exponent',3)
ylabel('Voltage (V)')
xlabel('bus number')
xlim([1 69])